<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="An Chu">
<meta name="dcterms.date" content="2024-02-04">

<title>A tidyverse user’s guide to polars library</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./first_steps.html" rel="next">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/quarto-contrib/line-highlight-1.0.0/line-highlight.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="custom.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./index.html">Preface</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./polars.jpg" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">A tidyverse user’s guide to polars library</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/chuvanan/cookbook-python-polars" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./first_steps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">First steps with Polars</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data_manipulation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data manipulation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./import_export.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Reading and writing data with Polars</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lazy_execution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">lazy_execution.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./examples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Polars in action</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summary &amp; references</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#preface" id="toc-preface" class="nav-link active" data-scroll-target="#preface">Preface</a>
  <ul class="collapse">
  <li><a href="#run-the-code-from-this-book" id="toc-run-the-code-from-this-book" class="nav-link" data-scroll-target="#run-the-code-from-this-book">Run the code from this book</a></li>
  <li><a href="#credit" id="toc-credit" class="nav-link" data-scroll-target="#credit">Credit</a></li>
  <li><a href="#contributing" id="toc-contributing" class="nav-link" data-scroll-target="#contributing">Contributing</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/chuvanan/cookbook-python-polars/edit/main/index.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/chuvanan/cookbook-python-polars/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li><li><a href="https://github.com/chuvanan/cookbook-python-polars/blob/main/index.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">A tidyverse user’s guide to polars library</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>An Chu </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 4, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="preface" class="level1 unnumbered">
<h1 class="unnumbered">Preface</h1>
<p>This book was inspired by a series of <a href="https://www.emilyriederer.com/post/py-rgo-polars/">blog posts</a> recommending a Pythonic data science stack that mimics the comfort and familiarity of R’s tidyverse tools. Particularly, this book explores the <code>Polars</code> library, a rising star in the DataFrame space (alongside established players like Pandas, Dask, Modin, Ray, and Vaex).</p>
<p>In a nutshell, Polars is defined as a <a href="https://pola.rs/posts/polars_birds_eye_view/">query engine with a DataFrame front-end</a>. It offers a rich set of intuitive functions and principled workflows for data manipulation and analysis. Designed from the ground up with performance in mind, Polars is also noted for its <a href="https://www.ritchievink.com/blog/2021/02/28/i-wrote-one-of-the-fastest-dataframe-libraries/">lightning-fast execution speed</a>. Polars, despite its quick rise in popularity, is still in its early stages of development.</p>
<p>The majority of this book contains structured examples of data wrangling tasks that demonstrates idiomatic Polars and related dplyr/tidyr code for comparison. Examples might include discussion on API choices.</p>
<div id="c388461e" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> polars <span class="im">as</span> pl</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> lets_plot <span class="im">import</span> <span class="op">*</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>LetsPlot.setup_html(no_js<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> okabeito(n):</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    pal <span class="op">=</span> [<span class="st">"#E69F00"</span>, <span class="st">"#56B4E9"</span>, <span class="st">"#009E73"</span>, <span class="st">"#F0E442"</span>, <span class="st">"#0072B2"</span>, <span class="st">"#D55E00"</span>, <span class="st">"#CC79A7"</span>, <span class="st">"#999999"</span>, <span class="st">"#000000"</span>]</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pal[<span class="dv">0</span>:n]</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>stars <span class="op">=</span> (</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    pl.read_csv(<span class="st">'./data/star-history-2024330.csv'</span>, has_header<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    .rename({<span class="st">'Repository'</span>: <span class="st">'project'</span>, <span class="st">'Date'</span>: <span class="st">'date'</span>, <span class="st">'Stars'</span>: <span class="st">'stars'</span>})</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    .with_columns(</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>        short_date<span class="op">=</span>pl.col(<span class="st">'date'</span>).<span class="bu">str</span>.<span class="bu">slice</span>(<span class="dv">0</span>, <span class="dv">15</span>).<span class="bu">str</span>.to_date(<span class="st">'%a %b </span><span class="sc">%d</span><span class="st"> %Y'</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    .sort(<span class="st">'short_date'</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    ggplot(stars.to_pandas(), aes(x<span class="op">=</span><span class="st">'short_date'</span>, y<span class="op">=</span><span class="st">'stars'</span>, color<span class="op">=</span><span class="st">'project'</span>)) <span class="op">+</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    geom_line(size<span class="op">=</span><span class="fl">1.5</span>) <span class="op">+</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    labs(y<span class="op">=</span><span class="st">'Github stars'</span>, title<span class="op">=</span><span class="st">'Polars is surging in popularity'</span>, caption<span class="op">=</span><span class="st">"Data as of Mar 2024"</span>) <span class="op">+</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    scale_x_datetime(name<span class="op">=</span><span class="st">'Date'</span>) <span class="op">+</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    theme(legend_title<span class="op">=</span>element_blank(), </span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>          text<span class="op">=</span>element_text(family<span class="op">=</span><span class="st">'Roboto Condensed'</span>, size<span class="op">=</span><span class="dv">15</span>),</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>         plot_title<span class="op">=</span>element_text(face<span class="op">=</span><span class="st">'bold'</span>, size<span class="op">=</span><span class="dv">18</span>)) <span class="op">+</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    scale_y_continuous(breaks<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">10_000</span>, <span class="dv">20_000</span>, <span class="dv">30_000</span>, <span class="dv">40_000</span>], <span class="bu">format</span><span class="op">=</span><span class="st">'0,'</span>, expand<span class="op">=</span>[<span class="fl">0.01</span>,<span class="fl">0.01</span>]) <span class="op">+</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    scale_color_manual(values<span class="op">=</span>okabeito(<span class="dv">5</span>)) <span class="op">+</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    ggsize(<span class="dv">700</span>,<span class="dv">380</span>)</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="1">
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" class="plt-container" width="700.0" height="380.0">
  <style type="text/css">
  .plt-container {
   font-family: Lucida Grande, sans-serif;
   user-select: none;
   -webkit-user-select: none;
   -moz-user-select: none;
   -ms-user-select: none;
}
text {
   text-rendering: optimizeLegibility;
}
#p2y1hBi .plot-title {
   fill: #474747;
   font-family: Roboto Condensed;
   font-size: 18.0px;
   font-weight: bold;
   font-style: normal;   
}
#p2y1hBi .plot-subtitle {
   fill: #474747;
   font-family: Roboto Condensed;
   font-size: 15.0px;
   font-weight: normal;
   font-style: normal;   
}
#p2y1hBi .plot-caption {
   fill: #474747;
   font-family: Roboto Condensed;
   font-size: 13.0px;
   font-weight: normal;
   font-style: normal;   
}
#p2y1hBi .legend-title {
   fill: #474747;
   font-family: Roboto Condensed;
   font-size: 15.0px;
   font-weight: normal;
   font-style: normal;   
}
#p2y1hBi .legend-item {
   fill: #474747;
   font-family: Roboto Condensed;
   font-size: 15.0px;
   font-weight: normal;
   font-style: normal;   
}
#p2y1hBi .axis-title-x {
   fill: #474747;
   font-family: Roboto Condensed;
   font-size: 15.0px;
   font-weight: normal;
   font-style: normal;   
}
#p2y1hBi .axis-text-x {
   fill: #474747;
   font-family: Roboto Condensed;
   font-size: 15.0px;
   font-weight: normal;
   font-style: normal;   
}
#d9lpjvf .axis-tooltip-text-x {
   fill: #ffffff;
   font-family: Roboto Condensed;
   font-size: 15.0px;
   font-weight: normal;
   font-style: normal;   
}
#p2y1hBi .axis-title-y {
   fill: #474747;
   font-family: Roboto Condensed;
   font-size: 15.0px;
   font-weight: normal;
   font-style: normal;   
}
#p2y1hBi .axis-text-y {
   fill: #474747;
   font-family: Roboto Condensed;
   font-size: 15.0px;
   font-weight: normal;
   font-style: normal;   
}
#d9lpjvf .axis-tooltip-text-y {
   fill: #ffffff;
   font-family: Roboto Condensed;
   font-size: 15.0px;
   font-weight: normal;
   font-style: normal;   
}
#p2y1hBi .facet-strip-text-x {
   fill: #474747;
   font-family: Roboto Condensed;
   font-size: 15.0px;
   font-weight: normal;
   font-style: normal;   
}
#p2y1hBi .facet-strip-text-y {
   fill: #474747;
   font-family: Roboto Condensed;
   font-size: 15.0px;
   font-weight: normal;
   font-style: normal;   
}
#d9lpjvf .tooltip-text {
   fill: #474747;
   font-family: Roboto Condensed;
   font-size: 15.0px;
   font-weight: normal;
   font-style: normal;   
}
#d9lpjvf .tooltip-title {
   fill: #474747;
   font-family: Roboto Condensed;
   font-size: 15.0px;
   font-weight: bold;
   font-style: normal;   
}
#d9lpjvf .tooltip-label {
   fill: #474747;
   font-family: Roboto Condensed;
   font-size: 15.0px;
   font-weight: bold;
   font-style: normal;   
}

  </style>
  <g id="p2y1hBi">
    <path fill-rule="evenodd" fill="rgb(255,255,255)" fill-opacity="1.0" d="M0.0 0.0 L0.0 380.0 L700.0 380.0 L700.0 0.0 Z">
    </path>
    <g transform="translate(23.0 36.0 ) ">
      <g transform="translate(57.89598183079157 0.0 ) ">
        <line x1="133.14506680421528" y1="275.0" x2="133.14506680421528" y2="0.0" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
        </line>
        <line x1="265.3237668800555" y1="275.0" x2="265.3237668800555" y2="0.0" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
        </line>
      </g>
      <g transform="translate(57.89598183079157 275.0 ) ">
        <g transform="translate(0.9663667283748509 0.0 ) ">
          <line stroke-width="1.0" stroke="rgb(71,71,71)" stroke-opacity="1.0" x2="0.0" y2="4.0">
          </line>
          <g transform="translate(0.0 7.0 ) ">
            <text class="axis-text-x" text-anchor="middle" dy="0.7em">
              <tspan>2010</tspan>
            </text>
          </g>
        </g>
        <g transform="translate(133.14506680421528 0.0 ) ">
          <line stroke-width="1.0" stroke="rgb(71,71,71)" stroke-opacity="1.0" x2="0.0" y2="4.0">
          </line>
          <g transform="translate(0.0 7.0 ) ">
            <text class="axis-text-x" text-anchor="middle" dy="0.7em">
              <tspan>2015</tspan>
            </text>
          </g>
        </g>
        <g transform="translate(265.3237668800555 0.0 ) ">
          <line stroke-width="1.0" stroke="rgb(71,71,71)" stroke-opacity="1.0" x2="0.0" y2="4.0">
          </line>
          <g transform="translate(0.0 7.0 ) ">
            <text class="axis-text-x" text-anchor="middle" dy="0.7em">
              <tspan>2020</tspan>
            </text>
          </g>
        </g>
        <line x1="0.0" y1="0.0" x2="395.50096582933656" y2="0.0" stroke-width="1.0" stroke="rgb(71,71,71)" stroke-opacity="1.0">
        </line>
      </g>
      <g transform="translate(57.89598183079157 0.0 ) ">
        <line x1="0.0" y1="207.6838216806567" x2="395.5009658293368" y2="207.6838216806567" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
        </line>
        <line x1="0.0" y1="143.063785145663" x2="395.5009658293368" y2="143.063785145663" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
        </line>
        <line x1="0.0" y1="78.44374861066925" x2="395.5009658293368" y2="78.44374861066925" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
        </line>
        <line x1="0.0" y1="13.82371207567553" x2="395.5009658293368" y2="13.82371207567553" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
        </line>
      </g>
      <g transform="translate(57.89598183079157 0.0 ) ">
        <g transform="translate(0.0 272.30385821565045 ) ">
          <g transform="translate(-3.0 0.0 ) ">
            <text class="axis-text-y" text-anchor="end" dy="0.35em">
              <tspan>0</tspan>
            </text>
          </g>
        </g>
        <g transform="translate(0.0 207.6838216806567 ) ">
          <g transform="translate(-3.0 0.0 ) ">
            <text class="axis-text-y" text-anchor="end" dy="0.35em">
              <tspan>10,000</tspan>
            </text>
          </g>
        </g>
        <g transform="translate(0.0 143.063785145663 ) ">
          <g transform="translate(-3.0 0.0 ) ">
            <text class="axis-text-y" text-anchor="end" dy="0.35em">
              <tspan>20,000</tspan>
            </text>
          </g>
        </g>
        <g transform="translate(0.0 78.44374861066925 ) ">
          <g transform="translate(-3.0 0.0 ) ">
            <text class="axis-text-y" text-anchor="end" dy="0.35em">
              <tspan>30,000</tspan>
            </text>
          </g>
        </g>
        <g transform="translate(0.0 13.82371207567553 ) ">
          <g transform="translate(-3.0 0.0 ) ">
            <text class="axis-text-y" text-anchor="end" dy="0.35em">
              <tspan>40,000</tspan>
            </text>
          </g>
        </g>
      </g>
      <g transform="translate(57.89598183079157 0.0 ) " clip-path="url(#cxFwaDt)" clip-bounds-jfx="[rect (0.0, 0.0), (395.50096582933656, 275.0)]">
        <defs>
          <clippath id="cxFwaDt">
            <rect x="0.0" y="0.0" width="395.50096582933656" height="275.0">
            </rect>
          </clippath>
        </defs>
        <g>
          <path d="M17.97731662860633 272.30385821565045 L17.97731662860633 272.30385821565045 L165.21251704167275 238.18447892517375 L190.69274838159367 220.93092917033044 L208.4275684903455 203.6773794154871 L222.76019861905115 186.42382966064378 L236.58611960179223 169.17027990580044 L250.5568146262376 151.9167301509571 L263.3693173170502 134.85704050571877 L276.3265940495669 117.60349075087544 L291.3830943867929 100.34994099603213 L306.15004664061075 83.0963912411888 L322.6542873948779 65.84284148634546 L338.000335815512 48.58929173150213 L351.8262567982533 31.335741976658824 L367.1723052188877 14.08219222181549 L377.52364920073046 2.6961417843496065 " fill="none" stroke-width="3.3000000000000003" stroke="rgb(230,159,0)" stroke-opacity="1.0">
          </path>
        </g>
        <g>
          <path d="M133.57938892932748 272.30385821565045 L133.57938892932748 272.30385821565045 L198.72770769617114 262.4169926257964 L217.04162397173923 257.1827696664619 L229.7817396416997 252.1424068167324 L241.87037212399196 246.90818385739792 L250.70158866794168 241.8678210076684 L261.1253196706368 236.6335980483339 L273.7206612988932 231.5932351986044 L286.7503250522618 226.3590122392699 L298.76657051370194 221.31864938954038 L313.09920064240737 216.0844264302059 L324.17441483277094 211.0440635804764 L340.24433346192563 205.80984062114192 L357.76199250812124 200.76947777141237 L376.6550049505058 195.53525481207788 L377.52364920073046 195.22507863670992 " fill="none" stroke-width="3.3000000000000003" stroke="rgb(86,180,233)" stroke-opacity="1.0">
          </path>
        </g>
        <g>
          <path d="M162.53419727014693 272.30385821565045 L162.53419727014693 272.30385821565045 L246.43075443767088 265.7126144890811 L257.7955167114426 262.2231325161914 L263.65886540045835 258.5397904336968 L267.71253856817316 255.05030846080712 L273.503500236337 251.56082648791747 L276.1818200078628 248.0713445150278 L278.4258176542762 244.58186254213814 L284.2891663432922 241.09238056924846 L292.2517386370175 237.6028985963588 L301.22772922267154 234.11341662346916 L312.9544266007033 230.43007454097452 L332.13698712649625 226.94059256808484 L345.0942638590129 223.4511105951952 L372.67371880364317 219.9616286223055 L377.52364920073046 219.57390840309557 " fill="none" stroke-width="3.3000000000000003" stroke="rgb(0,158,115)" stroke-opacity="1.0">
          </path>
        </g>
        <g>
          <path d="M224.93180924461262 272.30385821565045 L224.93180924461262 272.30385821565045 L242.95617743677258 264.5494538314512 L246.6479155002271 260.4783915297466 L256.49255033610575 256.407329228042 L262.1387379625653 252.33626692633737 L265.3961539009076 248.2652046246328 L272.63485598611237 244.19414232292817 L283.4929091139197 240.1230800212236 L297.3188300966608 236.05201771951897 L312.44771745473895 231.98095541781436 L325.18783312469964 227.90989311610974 L334.7429198771699 223.83883081440516 L346.6867783177579 219.76776851270054 L359.6440550502746 215.69670621099596 L376.6550049505058 211.62564390929134 L377.52364920073046 211.38008777045837 " fill="none" stroke-width="3.3000000000000003" stroke="rgb(240,228,66)" stroke-opacity="1.0">
          </path>
        </g>
        <g>
          <path d="M277.91910850831187 272.30385821565045 L277.91910850831187 272.30385821565045 L317.1528738101222 250.78538604949753 L325.83931631236806 239.7353598020136 L332.2817611682003 228.87919366413468 L339.375689211701 217.82916741665073 L343.71891046282394 206.7791411691668 L345.6009730049773 195.92297503128785 L347.9173576722428 184.8729487838039 L350.5232904229165 174.016782645925 L354.93889869489135 162.96675639844105 L360.00599015453486 151.9167301509571 L364.27682438480565 141.06056401307816 L369.7058509487092 130.01053776559425 L372.81849284534724 119.1543716277153 L377.3788751590264 108.10434538023136 L377.52364920073046 107.7489351792889 " fill="none" stroke-width="3.3000000000000003" stroke="rgb(0,114,178)" stroke-opacity="1.0">
          </path>
        </g>
      </g>
    </g>
    <g transform="translate(80.89598183079157 16.6 ) ">
      <text class="plot-title" y="0.0">
        <tspan>Polars is surging in popularity</tspan>
      </text>
    </g>
    <g transform="translate(14.5 173.5 ) rotate(-90.0 ) ">
      <text class="axis-title-y" y="0.0" text-anchor="middle">
        <tspan>Github stars</tspan>
      </text>
    </g>
    <g transform="translate(278.64646474545987 350.5 ) ">
      <text class="axis-title-x" y="0.0" text-anchor="middle">
        <tspan>Date</tspan>
      </text>
    </g>
    <g transform="translate(486.39694766012815 102.25 ) ">
      <rect x="5.0" y="5.0" height="132.5" width="203.60305233987182" stroke="rgb(71,71,71)" stroke-opacity="1.0" stroke-width="0.0" fill="rgb(255,255,255)" fill-opacity="1.0">
      </rect>
      <g transform="translate(10.0 10.0 ) ">
        <g transform="translate(0.0 7.5 ) ">
          <g transform="">
            <g>
              <rect x="0.0" y="0.0" height="23.0" width="23.0" stroke-width="0.0" fill="rgb(255,255,255)" fill-opacity="1.0">
              </rect>
              <g transform="translate(1.0 1.0 ) ">
                <g>
                  <line x1="0.0" y1="10.5" x2="21.0" y2="10.5" stroke="rgb(230,159,0)" stroke-opacity="1.0" fill="rgb(255,255,255)" fill-opacity="1.0" stroke-width="1.6500000000000001">
                  </line>
                </g>
              </g>
              <rect x="0.0" y="0.0" height="23.0" width="23.0" stroke="rgb(255,255,255)" stroke-opacity="1.0" stroke-width="1.0" fill-opacity="0.0">
              </rect>
            </g>
            <g transform="translate(27.604195455077807 16.75 ) ">
              <text class="legend-item" y="0.0">
                <tspan>pandas-dev/pandas</tspan>
              </text>
            </g>
          </g>
          <g transform="translate(0.0 23.0 ) ">
            <g>
              <rect x="0.0" y="0.0" height="23.0" width="23.0" stroke-width="0.0" fill="rgb(255,255,255)" fill-opacity="1.0">
              </rect>
              <g transform="translate(1.0 1.0 ) ">
                <g>
                  <line x1="0.0" y1="10.5" x2="21.0" y2="10.5" stroke="rgb(86,180,233)" stroke-opacity="1.0" fill="rgb(255,255,255)" fill-opacity="1.0" stroke-width="1.6500000000000001">
                  </line>
                </g>
              </g>
              <rect x="0.0" y="0.0" height="23.0" width="23.0" stroke="rgb(255,255,255)" stroke-opacity="1.0" stroke-width="1.0" fill-opacity="0.0">
              </rect>
            </g>
            <g transform="translate(27.604195455077807 16.75 ) ">
              <text class="legend-item" y="0.0">
                <tspan>dask/dask</tspan>
              </text>
            </g>
          </g>
          <g transform="translate(0.0 46.0 ) ">
            <g>
              <rect x="0.0" y="0.0" height="23.0" width="23.0" stroke-width="0.0" fill="rgb(255,255,255)" fill-opacity="1.0">
              </rect>
              <g transform="translate(1.0 1.0 ) ">
                <g>
                  <line x1="0.0" y1="10.5" x2="21.0" y2="10.5" stroke="rgb(0,158,115)" stroke-opacity="1.0" fill="rgb(255,255,255)" fill-opacity="1.0" stroke-width="1.6500000000000001">
                  </line>
                </g>
              </g>
              <rect x="0.0" y="0.0" height="23.0" width="23.0" stroke="rgb(255,255,255)" stroke-opacity="1.0" stroke-width="1.0" fill-opacity="0.0">
              </rect>
            </g>
            <g transform="translate(27.604195455077807 16.75 ) ">
              <text class="legend-item" y="0.0">
                <tspan>vaexio/vaex</tspan>
              </text>
            </g>
          </g>
          <g transform="translate(0.0 69.0 ) ">
            <g>
              <rect x="0.0" y="0.0" height="23.0" width="23.0" stroke-width="0.0" fill="rgb(255,255,255)" fill-opacity="1.0">
              </rect>
              <g transform="translate(1.0 1.0 ) ">
                <g>
                  <line x1="0.0" y1="10.5" x2="21.0" y2="10.5" stroke="rgb(240,228,66)" stroke-opacity="1.0" fill="rgb(255,255,255)" fill-opacity="1.0" stroke-width="1.6500000000000001">
                  </line>
                </g>
              </g>
              <rect x="0.0" y="0.0" height="23.0" width="23.0" stroke="rgb(255,255,255)" stroke-opacity="1.0" stroke-width="1.0" fill-opacity="0.0">
              </rect>
            </g>
            <g transform="translate(27.604195455077807 16.75 ) ">
              <text class="legend-item" y="0.0">
                <tspan>modin-project/modin</tspan>
              </text>
            </g>
          </g>
          <g transform="translate(0.0 92.0 ) ">
            <g>
              <rect x="0.0" y="0.0" height="23.0" width="23.0" stroke-width="0.0" fill="rgb(255,255,255)" fill-opacity="1.0">
              </rect>
              <g transform="translate(1.0 1.0 ) ">
                <g>
                  <line x1="0.0" y1="10.5" x2="21.0" y2="10.5" stroke="rgb(0,114,178)" stroke-opacity="1.0" fill="rgb(255,255,255)" fill-opacity="1.0" stroke-width="1.6500000000000001">
                  </line>
                </g>
              </g>
              <rect x="0.0" y="0.0" height="23.0" width="23.0" stroke="rgb(255,255,255)" stroke-opacity="1.0" stroke-width="1.0" fill-opacity="0.0">
              </rect>
            </g>
            <g transform="translate(27.604195455077807 16.75 ) ">
              <text class="legend-item" y="0.0">
                <tspan>pola-rs/polars</tspan>
              </text>
            </g>
          </g>
        </g>
      </g>
    </g>
    <g transform="translate(476.39694766012815 372.1 ) ">
      <text class="plot-caption" y="0.0" text-anchor="end">
        <tspan>Data as of Mar 2024</tspan>
      </text>
    </g>
    <path fill="rgb(0,0,0)" fill-opacity="0.0" stroke="rgb(71,71,71)" stroke-opacity="1.0" stroke-width="0.0" d="M0.0 0.0 L0.0 380.0 L700.0 380.0 L700.0 0.0 Z">
    </path>
  </g>
  <g id="d9lpjvf">
  </g>
</svg>
</div>
</div>
<section id="run-the-code-from-this-book" class="level2">
<h2 class="anchored" data-anchor-id="run-the-code-from-this-book">Run the code from this book</h2>
<ul>
<li>Clone the book repository:</li>
</ul>
<div class="sourceCode" id="cb2" data-code-line-numbers=""><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> clone https://github.com/chuvanan/cookbook-python-polars.git python-polars-cookbook</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> python-polars-cookbook</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="ex">python3</span> <span class="at">-m</span> venv env</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="bu">source</span> env/bin/activate</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>You can install the exact packages that the book uses with the <code>requirements.txt</code> file:</li>
</ul>
<div class="sourceCode" id="cb3" data-code-line-numbers=""><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ex">python3</span> <span class="at">-m</span> pip install <span class="at">-r</span> requirements.txt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Download the data (source: <a href="https://transtats.bts.gov/TableInfo.asp?gnoyr_VQ=FGJ&amp;QO_fu146_anzr=b0-gvzr&amp;V0s1_b0yB=D">Reporting carrier on-time performance</a>)</li>
</ul>
<div class="sourceCode" id="cb4" data-code-line-numbers=""><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> download-data.py</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="credit" class="level2">
<h2 class="anchored" data-anchor-id="credit">Credit</h2>
<p>This work builds upon the organizational style of <a href="https://ddotta.github.io/cookbook-rpolars/">https://ddotta.github.io/cookbook-rpolars/</a> but the content and examples are tailored to Polars library in Python. So credit goes to <a href="https://github.com/ddotta">Damien Dotta</a>, all remaining errors are mine.</p>
</section>
<section id="contributing" class="level2">
<h2 class="anchored" data-anchor-id="contributing">Contributing</h2>
<p>Feel free to open an <a href="https://github.com/chuvanan/cookbook-python-polars/issues">issue</a> if you notice any problems with this book. It’s free and open source, and your feedback is valuable to me.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
  </div>
  <div class="nav-page nav-page-next">
      <a href="./first_steps.html" class="pagination-link" aria-label="<span class='chapter-number'>1</span>&nbsp; <span class='chapter-title'>First steps with Polars</span>">
        <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">First steps with Polars</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/chuvanan/cookbook-python-polars/edit/main/index.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/chuvanan/cookbook-python-polars/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li><li><a href="https://github.com/chuvanan/cookbook-python-polars/blob/main/index.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li></ul></div></div></div></footer><script src="site_libs/quarto-contrib/line-highlight-1.0.0/line-highlight.js" defer="true"></script>
</body></html>